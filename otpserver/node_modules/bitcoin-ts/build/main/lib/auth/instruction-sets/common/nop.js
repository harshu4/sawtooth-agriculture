"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const errors_1 = require("./errors");
const opcodes_1 = require("./opcodes");
exports.opNop = (flags) => (state) => flags.disallowUpgradableNops
    ? errors_1.applyError(errors_1.AuthenticationErrorCommon.calledUpgradableNop, state)
    : state;
exports.nonOperations = (flags) => ({
    [opcodes_1.OpcodesCommon.OP_NOP]: exports.opNop(flags),
    [opcodes_1.OpcodesCommon.OP_NOP1]: exports.opNop(flags),
    [opcodes_1.OpcodesCommon.OP_NOP4]: exports.opNop(flags),
    [opcodes_1.OpcodesCommon.OP_NOP5]: exports.opNop(flags),
    [opcodes_1.OpcodesCommon.OP_NOP6]: exports.opNop(flags),
    [opcodes_1.OpcodesCommon.OP_NOP7]: exports.opNop(flags),
    [opcodes_1.OpcodesCommon.OP_NOP8]: exports.opNop(flags),
    [opcodes_1.OpcodesCommon.OP_NOP9]: exports.opNop(flags),
    [opcodes_1.OpcodesCommon.OP_NOP10]: exports.opNop(flags)
});
/**
 * "Disabled" operations are explicitly forbidden from occurring anywhere in a
 * script, even within an unexecuted branch.
 */
exports.disabledOperation = () => (state) => errors_1.applyError(errors_1.AuthenticationErrorCommon.unknownOpcode, state);
exports.disabledOperations = () => ({
    [opcodes_1.OpcodesCommon.OP_CAT]: exports.disabledOperation(),
    [opcodes_1.OpcodesCommon.OP_SUBSTR]: exports.disabledOperation(),
    [opcodes_1.OpcodesCommon.OP_LEFT]: exports.disabledOperation(),
    [opcodes_1.OpcodesCommon.OP_RIGHT]: exports.disabledOperation(),
    [opcodes_1.OpcodesCommon.OP_INVERT]: exports.disabledOperation(),
    [opcodes_1.OpcodesCommon.OP_AND]: exports.disabledOperation(),
    [opcodes_1.OpcodesCommon.OP_OR]: exports.disabledOperation(),
    [opcodes_1.OpcodesCommon.OP_XOR]: exports.disabledOperation(),
    [opcodes_1.OpcodesCommon.OP_2MUL]: exports.disabledOperation(),
    [opcodes_1.OpcodesCommon.OP_2DIV]: exports.disabledOperation(),
    [opcodes_1.OpcodesCommon.OP_MUL]: exports.disabledOperation(),
    [opcodes_1.OpcodesCommon.OP_DIV]: exports.disabledOperation(),
    [opcodes_1.OpcodesCommon.OP_MOD]: exports.disabledOperation(),
    [opcodes_1.OpcodesCommon.OP_LSHIFT]: exports.disabledOperation(),
    [opcodes_1.OpcodesCommon.OP_RSHIFT]: exports.disabledOperation()
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibm9wLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vc3JjL2xpYi9hdXRoL2luc3RydWN0aW9uLXNldHMvY29tbW9uL25vcC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUVBLHFDQUFpRTtBQUNqRSx1Q0FBMEM7QUFFN0IsUUFBQSxLQUFLLEdBQUcsQ0FBUSxLQUEwQyxFQUFFLEVBQUUsQ0FBQyxDQUMxRSxLQUFZLEVBQ1osRUFBRSxDQUNGLEtBQUssQ0FBQyxzQkFBc0I7SUFDMUIsQ0FBQyxDQUFDLG1CQUFVLENBQUMsa0NBQXlCLENBQUMsbUJBQW1CLEVBQUUsS0FBSyxDQUFDO0lBQ2xFLENBQUMsQ0FBQyxLQUFLLENBQUM7QUFFQyxRQUFBLGFBQWEsR0FBRyxDQUFRLEtBRXBDLEVBQUUsRUFBRSxDQUFDLENBQUM7SUFDTCxDQUFDLHVCQUFhLENBQUMsTUFBTSxDQUFDLEVBQUUsYUFBSyxDQUFRLEtBQUssQ0FBQztJQUMzQyxDQUFDLHVCQUFhLENBQUMsT0FBTyxDQUFDLEVBQUUsYUFBSyxDQUFRLEtBQUssQ0FBQztJQUM1QyxDQUFDLHVCQUFhLENBQUMsT0FBTyxDQUFDLEVBQUUsYUFBSyxDQUFRLEtBQUssQ0FBQztJQUM1QyxDQUFDLHVCQUFhLENBQUMsT0FBTyxDQUFDLEVBQUUsYUFBSyxDQUFRLEtBQUssQ0FBQztJQUM1QyxDQUFDLHVCQUFhLENBQUMsT0FBTyxDQUFDLEVBQUUsYUFBSyxDQUFRLEtBQUssQ0FBQztJQUM1QyxDQUFDLHVCQUFhLENBQUMsT0FBTyxDQUFDLEVBQUUsYUFBSyxDQUFRLEtBQUssQ0FBQztJQUM1QyxDQUFDLHVCQUFhLENBQUMsT0FBTyxDQUFDLEVBQUUsYUFBSyxDQUFRLEtBQUssQ0FBQztJQUM1QyxDQUFDLHVCQUFhLENBQUMsT0FBTyxDQUFDLEVBQUUsYUFBSyxDQUFRLEtBQUssQ0FBQztJQUM1QyxDQUFDLHVCQUFhLENBQUMsUUFBUSxDQUFDLEVBQUUsYUFBSyxDQUFRLEtBQUssQ0FBQztDQUM5QyxDQUFDLENBQUM7QUFFSDs7O0dBR0c7QUFDVSxRQUFBLGlCQUFpQixHQUFHLEdBRzdCLEVBQUUsQ0FBQyxDQUFDLEtBQVksRUFBRSxFQUFFLENBQ3RCLG1CQUFVLENBQWdCLGtDQUF5QixDQUFDLGFBQWEsRUFBRSxLQUFLLENBQUMsQ0FBQztBQUUvRCxRQUFBLGtCQUFrQixHQUFHLEdBRzlCLEVBQUUsQ0FBQyxDQUFDO0lBQ04sQ0FBQyx1QkFBYSxDQUFDLE1BQU0sQ0FBQyxFQUFFLHlCQUFpQixFQUFpQjtJQUMxRCxDQUFDLHVCQUFhLENBQUMsU0FBUyxDQUFDLEVBQUUseUJBQWlCLEVBQWlCO0lBQzdELENBQUMsdUJBQWEsQ0FBQyxPQUFPLENBQUMsRUFBRSx5QkFBaUIsRUFBaUI7SUFDM0QsQ0FBQyx1QkFBYSxDQUFDLFFBQVEsQ0FBQyxFQUFFLHlCQUFpQixFQUFpQjtJQUM1RCxDQUFDLHVCQUFhLENBQUMsU0FBUyxDQUFDLEVBQUUseUJBQWlCLEVBQWlCO0lBQzdELENBQUMsdUJBQWEsQ0FBQyxNQUFNLENBQUMsRUFBRSx5QkFBaUIsRUFBaUI7SUFDMUQsQ0FBQyx1QkFBYSxDQUFDLEtBQUssQ0FBQyxFQUFFLHlCQUFpQixFQUFpQjtJQUN6RCxDQUFDLHVCQUFhLENBQUMsTUFBTSxDQUFDLEVBQUUseUJBQWlCLEVBQWlCO0lBQzFELENBQUMsdUJBQWEsQ0FBQyxPQUFPLENBQUMsRUFBRSx5QkFBaUIsRUFBaUI7SUFDM0QsQ0FBQyx1QkFBYSxDQUFDLE9BQU8sQ0FBQyxFQUFFLHlCQUFpQixFQUFpQjtJQUMzRCxDQUFDLHVCQUFhLENBQUMsTUFBTSxDQUFDLEVBQUUseUJBQWlCLEVBQWlCO0lBQzFELENBQUMsdUJBQWEsQ0FBQyxNQUFNLENBQUMsRUFBRSx5QkFBaUIsRUFBaUI7SUFDMUQsQ0FBQyx1QkFBYSxDQUFDLE1BQU0sQ0FBQyxFQUFFLHlCQUFpQixFQUFpQjtJQUMxRCxDQUFDLHVCQUFhLENBQUMsU0FBUyxDQUFDLEVBQUUseUJBQWlCLEVBQWlCO0lBQzdELENBQUMsdUJBQWEsQ0FBQyxTQUFTLENBQUMsRUFBRSx5QkFBaUIsRUFBaUI7Q0FDOUQsQ0FBQyxDQUFDIn0=